(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     12883,        286]
NotebookOptionsPosition[     12588,        272]
NotebookOutlinePosition[     12934,        287]
CellTagsIndexPosition[     12891,        284]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"modified", " ", "tests", " ", "subtracting", " ", 
   RowBox[{"c", "/", "Ithc"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.487035049635*^9, 3.4870350540030003`*^9}, {
  3.487035130017*^9, 3.487035208565*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"piecewise", " ", "linear"}], ",", " ", 
    RowBox[{"with", " ", "ke", " ", "and", " ", "ki"}], ",", " ", 
    RowBox[{"without", " ", "boundary", " ", "conditions"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"Jii", "=", "0.001"}], ",", 
    RowBox[{"Jii", "\[LessEqual]", ".2"}], ",", 
    RowBox[{"Jii", "=", 
     RowBox[{"Jii", "+", ".001"}]}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"Jie", "=", "0.01"}], ",", 
      RowBox[{"Jie", "\[LessEqual]", "1"}], ",", 
      RowBox[{"Jie", "=", 
       RowBox[{"Jie", "+", ".02"}]}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"Jee", "=", "0.01"}], ",", 
        RowBox[{"Jee", "\[LessEqual]", "1"}], ",", 
        RowBox[{"Jee", "=", 
         RowBox[{"Jee", "+", ".02"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"c1", "=", 
          RowBox[{"a", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Is", "+", "Io"}], ")"}], "-", 
             RowBox[{"eIth", "/", "ce"}]}], ")"}]}]}], ";", 
         RowBox[{"c2", "=", 
          RowBox[{"a", "  ", "Jee"}]}], ";", " ", 
         RowBox[{"c3", "=", 
          RowBox[{"a", " ", "Jie"}]}], ";", 
         RowBox[{"c4", "=", " ", 
          RowBox[{"Io", "-", 
           RowBox[{"iIth", "/", "ci"}]}]}], ";", 
         RowBox[{"c5", "=", "Jei"}], ";", 
         RowBox[{"c6", "=", "Jii"}], ";", 
         RowBox[{"c9", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "k1"}], " ", "c3", " ", "k2", " ", 
            RowBox[{"c2", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"1", "/", "ti"}], "+", 
               RowBox[{"k2", " ", "c6"}]}], ")"}]}]}], "-", 
           RowBox[{"k1", " ", "c2"}]}]}], ";", 
         RowBox[{"c10", "=", 
          RowBox[{
           RowBox[{"k1", " ", "c2"}], " ", "-", 
           RowBox[{"1", "/", "te"}], " ", "-", 
           RowBox[{"k1", " ", "c1"}], " ", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"c4", "+", "c2"}], ")"}], "k1", " ", "c3", " ", 
            RowBox[{"k2", " ", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"1", "/", "ti"}], " ", "+", 
               RowBox[{"k2", " ", "c6"}]}], ")"}]}]}]}]}], ";", " ", 
         RowBox[{"c11", "=", 
          RowBox[{
           RowBox[{"k1", " ", "c1"}], "-", 
           RowBox[{"k1", " ", "c3", " ", "k2", " ", 
            RowBox[{"c4", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"1", "/", "ti"}], " ", "+", 
               RowBox[{"k2", " ", "c6"}]}], ")"}]}]}]}]}], ";", " ", 
         RowBox[{"Se", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "c10"}], "-", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"c10", " ", "^", "2"}], "-", 
               RowBox[{"4", " ", "c9", " ", "c11"}]}], "]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", "c9"}], ")"}]}]}], ";", 
         RowBox[{"Si", "=", 
          RowBox[{"k2", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"c4", "+", 
              RowBox[{"c2", " ", "Se"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"1", "/", "ti"}], " ", "+", " ", 
              RowBox[{"k2", " ", "c6"}]}], ")"}]}]}]}], ";", 
         RowBox[{"c7", " ", "=", " ", 
          RowBox[{
           RowBox[{"1", "/", "te"}], "-", 
           RowBox[{"k1", " ", "c2"}], " ", "+", 
           RowBox[{"2", " ", "k1", " ", "c2", " ", "Se"}], "+", 
           RowBox[{"1", "/", "ti"}], " ", "+", 
           RowBox[{"k2", " ", "c6"}]}]}], ";", 
         RowBox[{"c8", "=", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"te", " ", "ti"}], ")"}]}], "+", 
           RowBox[{"k2", " ", 
            RowBox[{"c6", "/", 
             RowBox[{"(", "te", ")"}]}]}], "-", 
           RowBox[{"k1", " ", 
            RowBox[{"c2", "/", "ti"}]}], " ", "-", 
           RowBox[{"k1", " ", "c2", " ", "k2", " ", "c6"}], " ", "+", " ", 
           RowBox[{"2", " ", "k1", " ", "c2", " ", 
            RowBox[{"Se", "/", "ti"}]}], "+", 
           RowBox[{"k1", " ", "k2", " ", "c5", " ", "c3"}], "+", 
           RowBox[{
           "2", " ", "k2", " ", "c6", " ", "k1", " ", "c2", " ", "Se"}], " ", 
           "-", 
           RowBox[{"k1", " ", "k2", " ", "c3", " ", "c5", " ", "Se"}]}]}], 
         ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Re", "[", "c7", "]"}], ">", 
             RowBox[{"-", ".5"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Re", "[", "c7", "]"}], "<", ".5"}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Im", "[", "c8", "]"}], "==", "0"}], "&&", " ", 
            RowBox[{
             RowBox[{"Re", "[", "c8", "]"}], ">", "0"}], "&&", 
            RowBox[{"Se", ">", "0"}], "&&", 
            RowBox[{"Se", "<", ".9"}], "&&", 
            RowBox[{"Si", ">", "0"}], "&&", 
            RowBox[{"Si", "<", "1"}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"k2", " ", 
              RowBox[{"c2", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"1", "/", "ti"}], " ", "+", " ", 
                 RowBox[{"k2", " ", "c6"}]}], ")"}]}]}], " ", ">", " ", 
             FractionBox[
              RowBox[{"c2", "-", 
               FractionBox["1", 
                RowBox[{"k1", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", "Se"}], ")"}], " ", "te"}]], "-", 
               FractionBox["Se", 
                RowBox[{"k1", " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"1", "-", "Se"}], ")"}], "2"], " ", "te"}]]}], 
              "c3"]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Io=\>\"", ",", "Io", ",", " ", "\"\< Jie=\>\"", ",", "Jie", 
              ",", "\"\< Jii=\>\"", ",", "Jii", ",", "\"\< Jee=\>\"", ",", 
              "Jee", ",", "\"\< Se=\>\"", ",", "Se", ",", "\"\< Si=\>\"", ",",
               "Si", ",", "\"\< Ie=\>\"", ",", 
              RowBox[{
               RowBox[{"Jee", " ", "Se"}], "-", 
               RowBox[{"Jie", " ", "Si"}], " ", "+", "Is", "+", "Io"}], ",", 
              "\"\< Ii=\>\"", ",", 
              RowBox[{
               RowBox[{"Jei", " ", "Se"}], " ", "-", 
               RowBox[{"Jii", " ", "Si"}], "+", "Io"}]}], "]"}], " ", "}"}], 
           ",", 
           RowBox[{"Continue", "[", "]"}]}], "]"}]}]}], "  ", "]"}]}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.486350045106*^9, 3.4863500463059998`*^9}, {
   3.486353053212*^9, 3.486353055539*^9}, {3.486353165157*^9, 
   3.486353214679*^9}, {3.486353660613*^9, 3.486353746351*^9}, {
   3.48635379376*^9, 3.486353887535*^9}, {3.486353977684*^9, 
   3.48635403494*^9}, {3.486354111686*^9, 3.486354142498*^9}, 
   3.4863541728640003`*^9, {3.486354255847*^9, 3.486354256054*^9}, {
   3.486354294335*^9, 3.486354300965*^9}, {3.486354340722*^9, 
   3.4863544090480003`*^9}, {3.486354440554*^9, 3.486354463453*^9}, {
   3.4863812847472277`*^9, 3.486381290758829*^9}, {3.4863813232070737`*^9, 
   3.4863813331910715`*^9}, {3.486381447723524*^9, 3.4863814917409253`*^9}, {
   3.4863816621329627`*^9, 3.4863816995097*^9}, {3.4863817468884373`*^9, 
   3.486381762889037*^9}, {3.4863818104267907`*^9, 3.486381842813029*^9}, 
   3.486381921248872*^9, {3.4863824257309837`*^9, 3.486382430769493*^9}, {
   3.48638521437024*^9, 3.486385217864685*^9}, {3.4863875199260435`*^9, 
   3.486387546649064*^9}, {3.4863881353548117`*^9, 3.4863881936995597`*^9}, {
   3.48638835410694*^9, 3.486388379691268*^9}, {3.486390480306558*^9, 
   3.4863904814920745`*^9}, 3.4863907054610806`*^9, {3.4863907828967843`*^9, 
   3.486390801788142*^9}, {3.486390837620883*^9, 3.4863908608177853`*^9}, {
   3.486391374149403*^9, 3.4863913742898045`*^9}, {3.4863920169071712`*^9, 
   3.4863920296213346`*^9}, {3.486392169087123*^9, 3.486392177620432*^9}, 
   3.486392237228796*^9, {3.4863924713253975`*^9, 3.486392478283087*^9}, {
   3.486393512078936*^9, 3.486393512687344*^9}, {3.4863937005605526`*^9, 
   3.486393785316439*^9}, 3.486394146783251*^9, {3.4863959379842973`*^9, 
   3.486395965752653*^9}, {3.4864172157891273`*^9, 3.4864172763171277`*^9}, {
   3.4864173805875273`*^9, 3.486417451718528*^9}, {3.4864189278851275`*^9, 
   3.4864189453259277`*^9}, {3.4864196192804985`*^9, 
   3.4864196214645967`*^9}, {3.4864196580638385`*^9, 3.4864197548336496`*^9}, 
   3.4864197891075087`*^9, {3.486419999650158*^9, 3.4864200061554413`*^9}, {
   3.486420196429861*^9, 3.486420199019478*^9}, {3.486420247488989*^9, 
   3.4864202502970066`*^9}, {3.4868324916975126`*^9, 
   3.4868325140865126`*^9}, {3.486832587434512*^9, 3.4868325924185123`*^9}, {
   3.4868326812355127`*^9, 3.4868326815845127`*^9}, {3.4868346041335125`*^9, 
   3.4868346065015125`*^9}, {3.4868346367225122`*^9, 3.486834664038512*^9}, {
   3.486839637983225*^9, 3.486839652132425*^9}, 3.4868396881586246`*^9, {
   3.486839745083025*^9, 3.486839758280625*^9}, {3.4868398010090246`*^9, 
   3.486839837778225*^9}, {3.4868398918166246`*^9, 3.4868398968242245`*^9}, {
   3.486840422175825*^9, 3.486840448898625*^9}, {3.486840504465825*^9, 
   3.4868406326822248`*^9}, {3.486906272432*^9, 3.486906289784*^9}, {
   3.48690665917*^9, 3.486906659635*^9}, {3.486907669446*^9, 
   3.486907674141*^9}, {3.486908670197*^9, 3.486908716955*^9}, {
   3.486908754909*^9, 3.486908758781*^9}, {3.486909137913*^9, 
   3.486909259359*^9}, {3.486909433541*^9, 3.486909464652*^9}, {
   3.486909523729*^9, 3.486909640091*^9}, {3.486913916708*^9, 
   3.4869139174709997`*^9}, 3.486913953865157*^9, {3.486914000493557*^9, 
   3.486914008870757*^9}, {3.486914126525957*^9, 3.4869141345599575`*^9}, {
   3.4869146628071575`*^9, 3.486914682166757*^9}, {3.486915172240757*^9, 
   3.4869152923919573`*^9}, {3.486915375742757*^9, 3.486915382669157*^9}, 
   3.4869154235411572`*^9, {3.4869155030699573`*^9, 3.4869155402135572`*^9}, {
   3.4869159717719574`*^9, 3.4869159760931573`*^9}, 3.486926506346506*^9, {
   3.4869266281669064`*^9, 3.4869266859649057`*^9}, {3.4869267973333063`*^9, 
   3.486926825629506*^9}, {3.4869270078375063`*^9, 3.4869270191163063`*^9}, 
   3.486927493777506*^9, 3.486936815659*^9, {3.486936850668*^9, 
   3.4869368533389997`*^9}, {3.4869369431400003`*^9, 3.486936964328*^9}, {
   3.4869371507650003`*^9, 3.486937152785*^9}, {3.48693724687*^9, 
   3.486937248724*^9}, {3.48694505785*^9, 3.4869450674040003`*^9}, {
   3.486945104701*^9, 3.486945139649*^9}, {3.486946479383*^9, 
   3.486946484624*^9}, {3.486946532375*^9, 3.486946569174*^9}, {
   3.486946788014*^9, 3.4869468466029997`*^9}, {3.486948591725*^9, 
   3.4869485938129997`*^9}, 3.486948635197*^9, {3.486949884877*^9, 
   3.486949932934*^9}, {3.486950443383*^9, 3.486950446281*^9}, 
   3.486954371273*^9, {3.4869547662349997`*^9, 3.486954769869*^9}, {
   3.486954865086*^9, 3.486954897532*^9}, {3.4869549778459997`*^9, 
   3.486955059542*^9}, {3.486955227775*^9, 3.486955316766*^9}, {
   3.486955354645*^9, 3.486955367374*^9}, {3.486955428479*^9, 
   3.486955432848*^9}, {3.486955671752*^9, 3.486955674995*^9}, 
   3.486970410295*^9, 3.487005214344701*^9, {3.4870052450157013`*^9, 
   3.4870052753067007`*^9}, {3.4870062967587013`*^9, 3.487006296915701*^9}, {
   3.487035228932*^9, 3.487035334212*^9}, {3.4870353767650003`*^9, 
   3.487035399465*^9}, {3.4870357705179996`*^9, 3.487035770855*^9}, {
   3.487035819322*^9, 3.487035819506*^9}}]
},
WindowSize->{607, 649},
WindowMargins->{{77, Automatic}, {-20, Automatic}},
FrontEndVersion->"7.0 for Microsoft Windows (32-bit) (February 18, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 250, 5, 31, "Input"],
Cell[798, 27, 11786, 243, 457, "Input"]
}
]
*)

(* End of internal cache information *)
