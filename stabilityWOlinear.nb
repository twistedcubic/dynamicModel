(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     34897,        938]
NotebookOptionsPosition[     33513,        891]
NotebookOutlinePosition[     33947,        908]
CellTagsIndexPosition[     33904,        905]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Compute", " ", "stability", " ", "before", " ", "linearization"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Fe", "[", "xe_", "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ce", " ", "xe"}], "-", "eIth"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "ge"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ce", " ", "xe"}], "-", "eIth"}], ")"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{"tre", "/", "1000"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ce", " ", "xe"}], "-", "eIth"}], ")"}]}]}], ")"}]}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.487013105730701*^9, 3.487013126019701*^9}, {
  3.487013184202701*^9, 3.487013205519701*^9}, {3.487013272709701*^9, 
  3.487013330915701*^9}, {3.487013918960701*^9, 3.487013935189701*^9}, {
  3.487014011783701*^9, 3.4870140810747013`*^9}, {3.487014255503701*^9, 
  3.4870142654237013`*^9}, {3.487014778277701*^9, 3.487014785965701*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Fi", "[", "xi_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ci", " ", "xi"}], "-", "iIth"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "gi"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ci", " ", "xi"}], "-", "iIth"}], ")"}]}], "]"}], "+", 
      RowBox[{
       RowBox[{"tri", "/", "1000"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ci", " ", "xi"}], "-", "iIth"}], ")"}]}]}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.487014074704701*^9, 3.487014097025701*^9}, {
  3.487014259204701*^9, 3.4870142623057013`*^9}, {3.4870146175237007`*^9, 
  3.487014623292701*^9}, {3.487014788434701*^9, 3.487014818811701*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{"Fe", "[", "xe", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.487014659003701*^9, 3.4870146704907007`*^9}, 
   3.487014841190701*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "eIth"}], "+", 
   RowBox[{"ce", " ", "xe"}]}], 
  RowBox[{"1", "-", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "ge"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "eIth"}], "+", 
       RowBox[{"ce", " ", "xe"}]}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{"tre", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "eIth"}], "+", 
       RowBox[{"ce", " ", "xe"}]}], ")"}]}], "1000"]}]]], "Output",
 CellChangeTimes->{{3.487014665869701*^9, 3.487014672020701*^9}, 
   3.4870148418137007`*^9, 3.48840449844*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"xe", "=", " ", 
   RowBox[{
    RowBox[{"Jee", " ", "Se"}], " ", "-", 
    RowBox[{"Jie", " ", "Si"}], "+", "Is", "+", "Io"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4870147681927013`*^9, 3.487014768293701*^9}, {
  3.4870148457547007`*^9, 3.487014848073701*^9}, {3.487015796644701*^9, 
  3.487015815341701*^9}, {3.487015862440701*^9, 3.4870158697917013`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xi", "=", 
   RowBox[{
    RowBox[{"Jei", " ", "Se"}], "-", 
    RowBox[{"Jii", " ", "Si"}], "+", "Io"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.487015873628701*^9, 3.4870158848717012`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "Se", ",", "Si", ",", "ce", ",", "ci", ",", "iIth", ",", "tri", ",", "eIth",
    ",", "tre", ",", "gi", ",", "ge", ",", "Jee", ",", "Is", ",", "Io", ",", 
   "Jie", ",", "Jei", ",", "Jii"}], "]"}]], "Input",
 CellChangeTimes->{{3.4870159665347013`*^9, 3.487015968637701*^9}, {
   3.487016964762701*^9, 3.487016966954701*^9}, {3.487068506506*^9, 
   3.487068519325*^9}, 3.4870701615629997`*^9, 3.4870703315109997`*^9, {
   3.487070536133*^9, 3.487070536409*^9}, {3.487070621477*^9, 
   3.487070622111*^9}, 3.487071407611*^9, {3.487075613859*^9, 
   3.487075614575*^9}, {3.487082337549*^9, 3.487082375016*^9}, {
   3.487082406691*^9, 3.487082415635*^9}, {3.487082477917*^9, 
   3.487082482599*^9}}],

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "Se"}], "/", "te"}], "+", 
    RowBox[{"a", 
     RowBox[{"(", 
      RowBox[{"1", "-", "Se"}], ")"}], 
     RowBox[{"Fe", "[", "xe", "]"}]}]}], ",", "Se"}], "]"}]], "Input",
 CellChangeTimes->{{3.4870159833577013`*^9, 3.487016008833701*^9}, {
  3.4884888859700003`*^9, 3.488488940447*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"dFe", "/", "dSe"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "eIth"}], "+", 
         RowBox[{"ce", " ", 
          RowBox[{"(", 
           RowBox[{"Io", "+", "Is", "+", 
            RowBox[{"Jee", " ", "Se"}], "-", 
            RowBox[{"Jie", " ", "Si"}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ce", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "ge"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "eIth"}], "+", 
              RowBox[{"ce", " ", 
               RowBox[{"(", 
                RowBox[{"Io", "+", "Is", "+", 
                 RowBox[{"Jee", " ", "Se"}], "-", 
                 RowBox[{"Jie", " ", "Si"}]}], ")"}]}]}], ")"}]}]], " ", "ge",
           " ", "Jee"}], "+", 
         FractionBox[
          RowBox[{"ce", " ", "Jee", " ", "tre"}], "1000"]}], ")"}]}], ")"}], 
     "/", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "ge"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "eIth"}], "+", 
            RowBox[{"ce", " ", 
             RowBox[{"(", 
              RowBox[{"Io", "+", "Is", "+", 
               RowBox[{"Jee", " ", "Se"}], "-", 
               RowBox[{"Jie", " ", "Si"}]}], ")"}]}]}], ")"}]}]], "+", 
        RowBox[{
         FractionBox["1", "1000"], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "eIth"}], "+", 
            RowBox[{"ce", " ", 
             RowBox[{"(", 
              RowBox[{"Io", "+", "Is", "+", 
               RowBox[{"Jee", " ", "Se"}], "-", 
               RowBox[{"Jie", " ", "Si"}]}], ")"}]}]}], ")"}], " ", 
          "tre"}]}]}], ")"}], "2"]}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"ce", " ", "Jee"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "ge"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "eIth"}], "+", 
          RowBox[{"ce", " ", 
           RowBox[{"(", 
            RowBox[{"Io", "+", "Is", "+", 
             RowBox[{"Jee", " ", "Se"}], "-", 
             RowBox[{"Jie", " ", "Si"}]}], ")"}]}]}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "eIth"}], "+", 
          RowBox[{"ce", " ", 
           RowBox[{"(", 
            RowBox[{"Io", "+", "Is", "+", 
             RowBox[{"Jee", " ", "Se"}], "-", 
             RowBox[{"Jie", " ", "Si"}]}], ")"}]}]}], ")"}], " ", "tre"}], 
       "1000"]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.488423521273*^9, 3.48842352865*^9}, {
  3.4884872639049997`*^9, 3.488487287848*^9}, {3.488488896873*^9, 
  3.488488910094*^9}}],

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"Fe", "[", "xe", "]"}], ",", "Si"}], "]"}]], "Input",
 CellChangeTimes->{3.488401967579*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "eIth"}], "+", 
        RowBox[{"ce", " ", 
         RowBox[{"(", 
          RowBox[{"Io", "+", "Is", "+", 
           RowBox[{"Jee", " ", "Se"}], "-", 
           RowBox[{"Jie", " ", "Si"}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "ce"}], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "ge"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "eIth"}], "+", 
             RowBox[{"ce", " ", 
              RowBox[{"(", 
               RowBox[{"Io", "+", "Is", "+", 
                RowBox[{"Jee", " ", "Se"}], "-", 
                RowBox[{"Jie", " ", "Si"}]}], ")"}]}]}], ")"}]}]], " ", "ge", 
         " ", "Jie"}], "-", 
        FractionBox[
         RowBox[{"ce", " ", "Jie", " ", "tre"}], "1000"]}], ")"}]}], ")"}]}], 
   "/", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "ge"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "eIth"}], "+", 
          RowBox[{"ce", " ", 
           RowBox[{"(", 
            RowBox[{"Io", "+", "Is", "+", 
             RowBox[{"Jee", " ", "Se"}], "-", 
             RowBox[{"Jie", " ", "Si"}]}], ")"}]}]}], ")"}]}]], "+", 
      RowBox[{
       FractionBox["1", "1000"], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "eIth"}], "+", 
          RowBox[{"ce", " ", 
           RowBox[{"(", 
            RowBox[{"Io", "+", "Is", "+", 
             RowBox[{"Jee", " ", "Se"}], "-", 
             RowBox[{"Jie", " ", "Si"}]}], ")"}]}]}], ")"}], " ", "tre"}]}]}],
      ")"}], "2"]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"ce", " ", "Jie"}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "ge"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "eIth"}], "+", 
         RowBox[{"ce", " ", 
          RowBox[{"(", 
           RowBox[{"Io", "+", "Is", "+", 
            RowBox[{"Jee", " ", "Se"}], "-", 
            RowBox[{"Jie", " ", "Si"}]}], ")"}]}]}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "eIth"}], "+", 
         RowBox[{"ce", " ", 
          RowBox[{"(", 
           RowBox[{"Io", "+", "Is", "+", 
            RowBox[{"Jee", " ", "Se"}], "-", 
            RowBox[{"Jie", " ", "Si"}]}], ")"}]}]}], ")"}], " ", "tre"}], 
      "1000"]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.488487466266*^9, 3.4884874689890003`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"Fi", "[", "xi", "]"}], ",", "Se"}], "]"}]], "Input",
 CellChangeTimes->{{3.488401974354*^9, 3.4884019760480003`*^9}, 
   3.4884045122869997`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "iIth"}], "+", 
        RowBox[{"ci", " ", 
         RowBox[{"(", 
          RowBox[{"Io", "+", 
           RowBox[{"Jei", " ", "Se"}], "-", 
           RowBox[{"Jii", " ", "Si"}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ci", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "gi"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "iIth"}], "+", 
             RowBox[{"ci", " ", 
              RowBox[{"(", 
               RowBox[{"Io", "+", 
                RowBox[{"Jei", " ", "Se"}], "-", 
                RowBox[{"Jii", " ", "Si"}]}], ")"}]}]}], ")"}]}]], " ", "gi", 
         " ", "Jei"}], "+", 
        FractionBox[
         RowBox[{"ci", " ", "Jei", " ", "tri"}], "1000"]}], ")"}]}], ")"}], 
    "/", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "gi"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "iIth"}], "+", 
           RowBox[{"ci", " ", 
            RowBox[{"(", 
             RowBox[{"Io", "+", 
              RowBox[{"Jei", " ", "Se"}], "-", 
              RowBox[{"Jii", " ", "Si"}]}], ")"}]}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "iIth"}], "+", 
           RowBox[{"ci", " ", 
            RowBox[{"(", 
             RowBox[{"Io", "+", 
              RowBox[{"Jei", " ", "Se"}], "-", 
              RowBox[{"Jii", " ", "Si"}]}], ")"}]}]}], ")"}], " ", "tri"}], 
        "1000"]}], ")"}], "2"]}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"ci", " ", "Jei"}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "gi"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "iIth"}], "+", 
         RowBox[{"ci", " ", 
          RowBox[{"(", 
           RowBox[{"Io", "+", 
            RowBox[{"Jei", " ", "Se"}], "-", 
            RowBox[{"Jii", " ", "Si"}]}], ")"}]}]}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "iIth"}], "+", 
         RowBox[{"ci", " ", 
          RowBox[{"(", 
           RowBox[{"Io", "+", 
            RowBox[{"Jei", " ", "Se"}], "-", 
            RowBox[{"Jii", " ", "Si"}]}], ")"}]}]}], ")"}], " ", "tri"}], 
      "1000"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.4884045359379997`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"Fi", "[", "xi", "]"}], ",", "Si"}], "]"}]], "Input",
 CellChangeTimes->{{3.487070531414*^9, 3.487070571139*^9}, {
  3.4870706342530003`*^9, 3.4870706477349997`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "iIth"}], "+", 
        RowBox[{"ci", " ", 
         RowBox[{"(", 
          RowBox[{"Io", "+", 
           RowBox[{"Jei", " ", "Se"}], "-", 
           RowBox[{"Jii", " ", "Si"}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "ci"}], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "gi"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "iIth"}], "+", 
             RowBox[{"ci", " ", 
              RowBox[{"(", 
               RowBox[{"Io", "+", 
                RowBox[{"Jei", " ", "Se"}], "-", 
                RowBox[{"Jii", " ", "Si"}]}], ")"}]}]}], ")"}]}]], " ", "gi", 
         " ", "Jii"}], "-", 
        FractionBox[
         RowBox[{"ci", " ", "Jii", " ", "tri"}], "1000"]}], ")"}]}], ")"}], 
    "/", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "gi"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "iIth"}], "+", 
           RowBox[{"ci", " ", 
            RowBox[{"(", 
             RowBox[{"Io", "+", 
              RowBox[{"Jei", " ", "Se"}], "-", 
              RowBox[{"Jii", " ", "Si"}]}], ")"}]}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "iIth"}], "+", 
           RowBox[{"ci", " ", 
            RowBox[{"(", 
             RowBox[{"Io", "+", 
              RowBox[{"Jei", " ", "Se"}], "-", 
              RowBox[{"Jii", " ", "Si"}]}], ")"}]}]}], ")"}], " ", "tri"}], 
        "1000"]}], ")"}], "2"]}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"ci", " ", "Jii"}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "gi"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "iIth"}], "+", 
         RowBox[{"ci", " ", 
          RowBox[{"(", 
           RowBox[{"Io", "+", 
            RowBox[{"Jei", " ", "Se"}], "-", 
            RowBox[{"Jii", " ", "Si"}]}], ")"}]}]}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "iIth"}], "+", 
         RowBox[{"ci", " ", 
          RowBox[{"(", 
           RowBox[{"Io", "+", 
            RowBox[{"Jei", " ", "Se"}], "-", 
            RowBox[{"Jii", " ", "Si"}]}], ")"}]}]}], ")"}], " ", "tri"}], 
      "1000"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.487103616868*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Se", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "c10"}], "-", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"c10", " ", "^", "2"}], "-", 
        RowBox[{"4", " ", "c9", " ", "c11"}]}], "]"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", "c9"}], ")"}]}]}], ";", 
  RowBox[{"Si", "=", 
   RowBox[{"k2", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"c4", "+", 
       RowBox[{"c2", " ", "Se"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "ti"}], " ", "+", " ", 
       RowBox[{"k2", " ", "c6"}]}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.487016940661701*^9, 3.487016950477701*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "try", " ", "out", " ", "which", " ", "slopes", " ", "k", " ", "gives", 
    " ", "Hopf", " ", "bifurcation"}], ",", " ", 
   RowBox[{
   "set", " ", "everything", " ", "else", " ", "as", " ", "a", " ", 
    "cosntant", " ", "except", " ", "for", " ", "k"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.487036054535*^9, 3.487036099726*^9}, {3.487037277627*^9,
   3.487037286303*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ti", "=", "2"}], " ", ";", " ", 
  RowBox[{"te", "=", " ", "100"}], ";", " ", 
  RowBox[{"Io", "=", " ", 
   RowBox[{"1", "/", "10"}]}], " ", 
  RowBox[{"(*", "background", "*)"}], ";", " ", 
  RowBox[{"eIth", "=", " ", "125"}], ";", 
  RowBox[{"iIth", "=", " ", "177"}], ";", " ", 
  RowBox[{"Is", "=", 
   RowBox[{"1", "/", "20"}]}], 
  RowBox[{"(*", "stimulus", "*)"}], ";", 
  RowBox[{"a", "=", 
   RowBox[{"64", "/", "100"}]}], ";", " ", 
  RowBox[{"gi", "=", ".087"}], ";", 
  RowBox[{"ge", "=", ".16"}], ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "linear", " ", "estimate", " ", "for", " ", "excitaory", " ", "and", " ", 
     "inhibitory", " ", "input"}], "-", 
    RowBox[{"output", " ", "functions"}]}], "*)"}], "  ", 
  RowBox[{"Io", "=", 
   RowBox[{"2", "/", "10"}]}], ";", 
  RowBox[{"Jei", "=", 
   RowBox[{"15", "/", "100"}]}], ";", " ", 
  RowBox[{"tre", "=", "2"}], ";", 
  RowBox[{"tri", "=", "1"}], ";", 
  RowBox[{"Io", "=", ".2"}], ";", " ", 
  RowBox[{"Jie", "=", "0.93"}], ";", " ", 
  RowBox[{"Jii", "=", "0.035"}], ";", " ", 
  RowBox[{"Jee", "=", "0.84"}], ";"}]], "Input",
 CellChangeTimes->{
  3.486216352984*^9, {3.486216985953*^9, 3.486216995969*^9}, {
   3.486217285259*^9, 3.48621728585*^9}, {3.486217424275*^9, 
   3.4862174317609997`*^9}, {3.48621760124*^9, 3.486217621724*^9}, 
   3.486218218034*^9, {3.486218501164*^9, 3.486218599094*^9}, {
   3.486218930318*^9, 3.486218963788*^9}, {3.486219086376*^9, 
   3.4862191168599997`*^9}, {3.486219167271*^9, 3.486219170854*^9}, {
   3.486219226403*^9, 3.486219285617*^9}, {3.486219420725*^9, 
   3.486219468079*^9}, {3.486219919693*^9, 3.4862199747060003`*^9}, {
   3.486221275876*^9, 3.486221280284*^9}, {3.486221338933*^9, 
   3.486221339475*^9}, {3.486221377898*^9, 3.486221384828*^9}, {
   3.4862216172539997`*^9, 3.48622164599*^9}, {3.486221722177*^9, 
   3.486221752124*^9}, {3.486221831046*^9, 3.4862218707679996`*^9}, {
   3.4862224355439997`*^9, 3.486222438124*^9}, 3.486224058045*^9, 
   3.486227464895*^9, {3.4862291828970003`*^9, 3.4862291852209997`*^9}, 
   3.486229634204*^9, {3.486229705709*^9, 3.486229706554*^9}, {
   3.4862302700360003`*^9, 3.4862302980950003`*^9}, 3.486237575618709*^9, 
   3.4862378338727093`*^9, 3.486237916269709*^9, {3.486238046692709*^9, 
   3.486238046814709*^9}, {3.4862382518567095`*^9, 3.4862382660897093`*^9}, 
   3.486239852114709*^9, {3.486240153119709*^9, 3.486240157493709*^9}, 
   3.486249677441*^9, {3.4862568589421997`*^9, 3.4862568659842*^9}, {
   3.4863412177720003`*^9, 3.486341251958*^9}, {3.4863419290439997`*^9, 
   3.48634199046*^9}, {3.486342171192*^9, 3.4863422067019997`*^9}, 
   3.4863432457980003`*^9, {3.4863434284230003`*^9, 3.4863434289370003`*^9}, {
   3.4863935297383623`*^9, 3.4863935349332294`*^9}, {3.486393577428174*^9, 
   3.4863936399693756`*^9}, 3.4864173248019276`*^9, {3.486779324354*^9, 
   3.4867793273710003`*^9}, {3.4868265870825124`*^9, 
   3.4868265996435127`*^9}, {3.4868266362095127`*^9, 
   3.4868266407215123`*^9}, {3.4868395815112247`*^9, 3.486839590871225*^9}, 
   3.486839693275425*^9, {3.486840802659825*^9, 3.4868408035490246`*^9}, {
   3.4868408421590247`*^9, 3.486840842283825*^9}, {3.4868409635426245`*^9, 
   3.486840964743825*^9}, {3.486841006895025*^9, 3.486841006957425*^9}, {
   3.4870141956217012`*^9, 3.487014205295701*^9}, {3.487014246904701*^9, 
   3.4870142469837008`*^9}, {3.487037309672*^9, 3.487037310708*^9}, {
   3.487037722117*^9, 3.4870377305039997`*^9}, 3.487038162572*^9, 
   3.487073364132*^9}],

Cell[CellGroupData[{

Cell[BoxData["ci"], "Input",
 CellChangeTimes->{{3.487073006192*^9, 3.487073028249*^9}}],

Cell[BoxData["615"], "Output",
 CellChangeTimes->{{3.487073006942*^9, 3.48707302854*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"modified", " ", "test"}], ",", " ", 
    RowBox[{"piecewise", " ", "linear"}], ",", " ", 
    RowBox[{"with", " ", "ke", " ", "and", " ", "ki"}], ",", " ", 
    RowBox[{"without", " ", "boundary", " ", 
     RowBox[{"conditions", ".", " ", "Look"}], " ", "for", " ", "conditions", 
     " ", "of", " ", "ce", " ", "and", " ", "ci", " ", "such", " ", "that", 
     " ", "conditions", " ", "are", " ", 
     RowBox[{"satisfied", ".", " ", 
      RowBox[{"(", 
       RowBox[{"need", " ", "to", " ", "improve"}], ")"}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ce", "=", "1"}], ",", 
    RowBox[{"ce", "\[LessEqual]", "500"}], ",", 
    RowBox[{"ce", "=", 
     RowBox[{"ce", "+", "1"}]}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"ci", "=", "300"}], ",", 
      RowBox[{"ci", "\[LessEqual]", "800"}], ",", 
      RowBox[{"ci", "=", 
       RowBox[{"ci", "+", "1"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "\[IndentingNewLine]", "\[IndentingNewLine]", "c1"}], 
        "=", 
        RowBox[{"a", " ", "ce", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Is", "+", "Io"}], ")"}], "-", "eIth"}], ")"}]}]}], ";", 
       RowBox[{"c2", "=", 
        RowBox[{"a", " ", "ce", " ", "Jee"}]}], ";", " ", 
       RowBox[{"c3", "=", 
        RowBox[{"a", " ", "ce", " ", "Jie"}]}], ";", 
       RowBox[{"c4", "=", " ", 
        RowBox[{
         RowBox[{"ci", " ", "Io"}], "-", "iIth"}]}], ";", 
       RowBox[{"c5", "=", 
        RowBox[{"ci", " ", "Jei"}]}], ";", 
       RowBox[{"c6", "=", 
        RowBox[{"ci", " ", "Jii"}]}], ";", 
       RowBox[{"c9", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "k1"}], " ", "c3", " ", "k2", " ", 
          RowBox[{"c2", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"1", "/", "ti"}], "+", 
             RowBox[{"k2", " ", "c6"}]}], ")"}]}]}], "-", 
         RowBox[{"k1", " ", "c2"}]}]}], ";", 
       RowBox[{"c10", "=", 
        RowBox[{
         RowBox[{"k1", " ", "c2"}], " ", "-", 
         RowBox[{"1", "/", "te"}], " ", "-", 
         RowBox[{"k1", " ", "c1"}], " ", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"c4", "+", "c2"}], ")"}], "k1", " ", "c3", " ", 
          RowBox[{"k2", " ", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"1", "/", "ti"}], " ", "+", 
             RowBox[{"k2", " ", "c6"}]}], ")"}]}]}]}]}], ";", " ", 
       RowBox[{"c11", "=", 
        RowBox[{
         RowBox[{"k1", " ", "c1"}], "-", 
         RowBox[{"k1", " ", "c3", " ", "k2", " ", 
          RowBox[{"c4", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"1", "/", "ti"}], " ", "+", 
             RowBox[{"k2", " ", "c6"}]}], ")"}]}]}]}]}], ";", " ", 
       RowBox[{"Se", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c10"}], "+", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"c10", " ", "^", "2"}], "-", 
             RowBox[{"4", " ", "c9", " ", "c11"}]}], "]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", " ", "c9"}], ")"}]}]}], ";", 
       RowBox[{"Si", "=", 
        RowBox[{"k2", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"c4", "+", 
            RowBox[{"c2", " ", "Se"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"1", "/", "ti"}], " ", "+", " ", 
            RowBox[{"k2", " ", "c6"}]}], ")"}]}]}]}], ";", 
       RowBox[{"c7", " ", "=", " ", 
        RowBox[{
         RowBox[{"1", "/", "te"}], "-", 
         RowBox[{"k1", " ", "c2"}], " ", "+", 
         RowBox[{"2", " ", "k1", " ", "c2", " ", "Se"}], "+", 
         RowBox[{"1", "/", "ti"}], " ", "+", 
         RowBox[{"k2", " ", "c6"}]}]}], ";", 
       RowBox[{"c8", "=", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"te", " ", "ti"}], ")"}]}], "+", 
         RowBox[{"k2", " ", 
          RowBox[{"c6", "/", 
           RowBox[{"(", "te", ")"}]}]}], "-", 
         RowBox[{"k1", " ", 
          RowBox[{"c2", "/", "ti"}]}], " ", "-", 
         RowBox[{"k1", " ", "c2", " ", "k2", " ", "c6"}], " ", "+", " ", 
         RowBox[{"2", " ", "k1", " ", "c2", " ", 
          RowBox[{"Se", "/", "ti"}]}], "+", 
         RowBox[{"k1", " ", "k2", " ", "c5", " ", "c3"}], "+", 
         RowBox[{"2", " ", "k2", " ", "c6", " ", "k1", " ", "c2", " ", "Se"}],
          " ", "-", 
         RowBox[{"k1", " ", "k2", " ", "c3", " ", "c5", " ", "Se"}]}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", "c7", "]"}], ">", 
           RowBox[{"-", ".5"}]}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"Re", "[", "c7", "]"}], "<", ".5"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"Im", "[", "c8", "]"}], "==", "0"}], "&&", " ", 
          RowBox[{
           RowBox[{"Re", "[", "c8", "]"}], ">", "0"}], "&&", 
          RowBox[{"Se", ">", "0"}], "&&", 
          RowBox[{"Se", "<", ".9"}], "&&", 
          RowBox[{"Si", ">", "0"}], "&&", 
          RowBox[{"Si", "<", "1"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\< Se=\>\"", ",", "Se", ",", "\"\< Si=\>\"", ",", "Si", ",", 
            "\"\< k1=\>\"", ",", "k1", ",", "\"\< k2=\>\"", ",", "k2"}], 
           "]"}], " ", "}"}], ",", 
         RowBox[{"Continue", "[", "]"}]}], "]"}]}]}], "  ", "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.486350045106*^9, 3.4863500463059998`*^9}, {
   3.486353053212*^9, 3.486353055539*^9}, {3.486353165157*^9, 
   3.486353214679*^9}, {3.486353660613*^9, 3.486353746351*^9}, {
   3.48635379376*^9, 3.486353887535*^9}, {3.486353977684*^9, 
   3.48635403494*^9}, {3.486354111686*^9, 3.486354142498*^9}, 
   3.4863541728640003`*^9, {3.486354255847*^9, 3.486354256054*^9}, {
   3.486354294335*^9, 3.486354300965*^9}, {3.486354340722*^9, 
   3.4863544090480003`*^9}, {3.486354440554*^9, 3.486354463453*^9}, {
   3.4863812847472277`*^9, 3.486381290758829*^9}, {3.4863813232070737`*^9, 
   3.4863813331910715`*^9}, {3.486381447723524*^9, 3.4863814917409253`*^9}, {
   3.4863816621329627`*^9, 3.4863816995097*^9}, {3.4863817468884373`*^9, 
   3.486381762889037*^9}, {3.4863818104267907`*^9, 3.486381842813029*^9}, 
   3.486381921248872*^9, {3.4863824257309837`*^9, 3.486382430769493*^9}, {
   3.48638521437024*^9, 3.486385217864685*^9}, {3.4863875199260435`*^9, 
   3.486387546649064*^9}, {3.4863881353548117`*^9, 3.4863881936995597`*^9}, {
   3.48638835410694*^9, 3.486388379691268*^9}, {3.486390480306558*^9, 
   3.4863904814920745`*^9}, 3.4863907054610806`*^9, {3.4863907828967843`*^9, 
   3.486390801788142*^9}, {3.486390837620883*^9, 3.4863908608177853`*^9}, {
   3.486391374149403*^9, 3.4863913742898045`*^9}, {3.4863920169071712`*^9, 
   3.4863920296213346`*^9}, {3.486392169087123*^9, 3.486392177620432*^9}, 
   3.486392237228796*^9, {3.4863924713253975`*^9, 3.486392478283087*^9}, {
   3.486393512078936*^9, 3.486393512687344*^9}, {3.4863937005605526`*^9, 
   3.486393785316439*^9}, 3.486394146783251*^9, {3.4863959379842973`*^9, 
   3.486395965752653*^9}, {3.4864172157891273`*^9, 3.4864172763171277`*^9}, {
   3.4864173805875273`*^9, 3.486417451718528*^9}, {3.4864189278851275`*^9, 
   3.4864189453259277`*^9}, {3.4864196192804985`*^9, 
   3.4864196214645967`*^9}, {3.4864196580638385`*^9, 3.4864197548336496`*^9}, 
   3.4864197891075087`*^9, {3.486419999650158*^9, 3.4864200061554413`*^9}, {
   3.486420196429861*^9, 3.486420199019478*^9}, {3.486420247488989*^9, 
   3.4864202502970066`*^9}, {3.4868324916975126`*^9, 
   3.4868325140865126`*^9}, {3.486832587434512*^9, 3.4868325924185123`*^9}, {
   3.4868326812355127`*^9, 3.4868326815845127`*^9}, {3.4868346041335125`*^9, 
   3.4868346065015125`*^9}, {3.4868346367225122`*^9, 3.486834664038512*^9}, {
   3.486839637983225*^9, 3.486839652132425*^9}, 3.4868396881586246`*^9, {
   3.486839745083025*^9, 3.486839758280625*^9}, {3.4868398010090246`*^9, 
   3.486839837778225*^9}, {3.4868398918166246`*^9, 3.4868398968242245`*^9}, {
   3.486840422175825*^9, 3.486840448898625*^9}, {3.486840504465825*^9, 
   3.4868406326822248`*^9}, {3.486906272432*^9, 3.486906289784*^9}, {
   3.48690665917*^9, 3.486906659635*^9}, {3.486907669446*^9, 
   3.486907674141*^9}, {3.486908670197*^9, 3.486908716955*^9}, {
   3.486908754909*^9, 3.486908758781*^9}, {3.486909137913*^9, 
   3.486909259359*^9}, {3.486909433541*^9, 3.486909464652*^9}, {
   3.486909523729*^9, 3.486909640091*^9}, {3.486913916708*^9, 
   3.4869139174709997`*^9}, 3.486913953865157*^9, {3.486914000493557*^9, 
   3.486914008870757*^9}, {3.486914126525957*^9, 3.4869141345599575`*^9}, {
   3.4869146628071575`*^9, 3.486914682166757*^9}, {3.486915172240757*^9, 
   3.4869152923919573`*^9}, {3.486915375742757*^9, 3.486915382669157*^9}, 
   3.4869154235411572`*^9, {3.4869155030699573`*^9, 3.4869155402135572`*^9}, {
   3.4869159717719574`*^9, 3.4869159760931573`*^9}, 3.486926506346506*^9, {
   3.4869266281669064`*^9, 3.4869266859649057`*^9}, {3.4869267973333063`*^9, 
   3.486926825629506*^9}, {3.4869270078375063`*^9, 3.4869270191163063`*^9}, 
   3.486927493777506*^9, 3.486936815659*^9, {3.486936850668*^9, 
   3.4869368533389997`*^9}, {3.4869369431400003`*^9, 3.486936964328*^9}, {
   3.4869371507650003`*^9, 3.486937152785*^9}, {3.48693724687*^9, 
   3.486937248724*^9}, {3.48694505785*^9, 3.4869450674040003`*^9}, {
   3.486945104701*^9, 3.486945139649*^9}, {3.486946479383*^9, 
   3.486946484624*^9}, {3.486946532375*^9, 3.486946569174*^9}, {
   3.486946788014*^9, 3.4869468466029997`*^9}, {3.486948591725*^9, 
   3.4869485938129997`*^9}, 3.486948635197*^9, {3.486949884877*^9, 
   3.486949932934*^9}, {3.486950443383*^9, 3.486950446281*^9}, 
   3.486954371273*^9, {3.4869547662349997`*^9, 3.486954769869*^9}, {
   3.486954865086*^9, 3.486954897532*^9}, {3.4869549778459997`*^9, 
   3.486955059542*^9}, {3.486955227775*^9, 3.486955316766*^9}, {
   3.486955354645*^9, 3.486955367374*^9}, {3.486955428479*^9, 
   3.486955432848*^9}, {3.486955671752*^9, 3.486955674995*^9}, 
   3.486970410295*^9, 3.487005214344701*^9, {3.4870052450157013`*^9, 
   3.4870052753067007`*^9}, {3.4870062967587013`*^9, 3.487006296915701*^9}, {
   3.487035228932*^9, 3.487035334212*^9}, {3.4870353767650003`*^9, 
   3.487035399465*^9}, {3.4870357705179996`*^9, 3.487035770855*^9}, {
   3.487035819322*^9, 3.487035819506*^9}, {3.4870375037460003`*^9, 
   3.487037543335*^9}, {3.487037755756*^9, 3.4870377896619997`*^9}, {
   3.4870378821219997`*^9, 3.487037928458*^9}, {3.4870380849969997`*^9, 
   3.4870381162530003`*^9}, {3.487038186859*^9, 3.487038197631*^9}, {
   3.48703824329*^9, 3.487038249356*^9}, {3.487038290342*^9, 
   3.487038294475*^9}, {3.487038360139*^9, 3.487038396033*^9}, {
   3.487038441547*^9, 3.487038448007*^9}, {3.4870385235889997`*^9, 
   3.4870385239049997`*^9}, {3.487043812645*^9, 3.487043831903*^9}, {
   3.487068466325*^9, 3.487068470899*^9}, {3.48707154013*^9, 
   3.487071576934*^9}, {3.48707298019*^9, 3.487073038671*^9}, {
   3.487073178757*^9, 3.487073213334*^9}, {3.487073299751*^9, 
   3.487073300242*^9}, 3.487073352245*^9, {3.487073385472*^9, 
   3.487073390965*^9}, {3.487285088674*^9, 3.4872850994309998`*^9}, {
   3.64656864162647*^9, 3.6465686445369787`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["Si"], "Input",
 CellChangeTimes->{{3.487038209894*^9, 3.487038222927*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.05642742794086087`"}]], "Output",
 CellChangeTimes->{{3.4870382103269997`*^9, 3.487038223284*^9}}]
}, Open  ]]
},
WindowSize->{607, 646},
WindowMargins->{{77, Automatic}, {24, Automatic}},
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.25, 1.25 Inherited],
FrontEndVersion->"10.2 for Linux x86 (64-bit) (July 6, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 1123, 30, 139, "Input"],
Cell[1671, 52, 814, 24, 89, "Input"],
Cell[CellGroupData[{
Cell[2510, 80, 178, 4, 38, "Input"],
Cell[2691, 86, 620, 20, 79, "Output"]
}, Open  ]],
Cell[3326, 109, 396, 8, 38, "Input"],
Cell[3725, 119, 227, 6, 38, "Input"],
Cell[3955, 127, 747, 13, 89, "Input"],
Cell[4705, 142, 378, 11, 38, "Input"],
Cell[5086, 155, 3035, 90, 575, "Input"],
Cell[8124, 247, 148, 4, 38, "Input"],
Cell[8275, 253, 2768, 86, 559, "Input"],
Cell[CellGroupData[{
Cell[11068, 343, 202, 5, 38, "Input"],
Cell[11273, 350, 2662, 84, 381, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13972, 439, 222, 5, 38, "Input"],
Cell[14197, 446, 2682, 85, 381, "Output"]
}, Open  ]],
Cell[16894, 534, 711, 23, 64, "Input"],
Cell[17608, 559, 437, 10, 114, "Input"],
Cell[18048, 571, 3536, 67, 239, "Input"],
Cell[CellGroupData[{
Cell[21609, 642, 88, 1, 38, "Input"],
Cell[21700, 645, 89, 1, 38, "Output"]
}, Open  ]],
Cell[21804, 649, 11448, 230, 839, "Input"],
Cell[CellGroupData[{
Cell[33277, 883, 88, 1, 38, "Input"],
Cell[33368, 886, 129, 2, 38, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
